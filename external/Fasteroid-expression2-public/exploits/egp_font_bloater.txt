@name exploits/egp_font_bloater
@inputs EGP:wirelink
@persist State Instances OBJECT_AMOUNT

# by Fasteroid
# EGP version of font_bloater.txt, with adjustable power
# can cure the effects of egp_font_corruptor.txt

if( first() ){
    OBJECT_AMOUNT = 24 # pls experiment
    Instances = 0 # stupid warnings
}

if( ->EGP ){
    State = 1
}

event tick(){
    switch( State ){
        case 1,
            while( opcounter() < softQuota() & Instances < OBJECT_AMOUNT ){
                EGP:egpText(Instances, "A", randvec2(vec2(),vec2(512)))
                Instances++
            }
            if( Instances == OBJECT_AMOUNT ){
                Instances = 0
                State = 2
            }
        break
        
        case 2,
            local Lines = 0
            while( opcounter() < softQuota() & Lines < OBJECT_AMOUNT ){
                EGP:egpFont(Instances, random()+"")
                Instances = (Instances + 1) % OBJECT_AMOUNT
                Lines++
            }        
        break
    }
}
