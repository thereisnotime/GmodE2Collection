@name exploits/nightmare_fuel
@persist Spawned EntCount Pos:vector
@model models/hunter/misc/sphere075x075.mdl

# Accidentally patched Jun 13 2023 in commit 250f11d, gmod_wire_expression2/core/custom/prop.lua:104
# https://github.com/wiremod/wire/commit/250f11d

# by Fasteroid
# powered by propSpawn ragdolls (might not work on all servers)
# wanders around aimlessly and drops your framerate
# may cause intense panic and fear

if( first() ){
    
    entity():makeSpherical(22)
    
    EntCount = 256
    
    runOnTick(1)
    propSpawnUndo(0)
    soundPlay(1,0,"ambient/levels/citadel/citadel_hit1_adpcm.wav")
    holoCreate(1)
    
    entity():setColor(vec())
    entity():propFreeze(0)
    entity():applyForce(randvec())
    
}

if(Spawned<EntCount){
    if(propCanCreate()){
        H = holoEntity(1)
        Spawned++
        E=propSpawn("models/Combine_Strider.mdl",H:pos(),H:toWorld(ang(random(-20,20),random(-30,30),random(-20,20))),1)
        E:setColor(vec())
        E:parentTo(H)
        E:propNotSolid(1)
    }
}

R = rangerOffset(9999,entity():pos(),vec(0,0,-1))
holoPos(1,R:position()+vec(0,0,350))

if(R:position():distance(Pos) > 40){
    holoAng(1,(R:position()-Pos):setZ(0):toAngle())    
    Pos = R:position()
}

entity():applyForce(entity():vel():setZ(0):normalized()*1660 - entity():vel()*2)
